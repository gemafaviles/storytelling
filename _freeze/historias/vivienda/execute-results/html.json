{
  "hash": "8dab2f66a541793f219cd60d77610822",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Vivienda\"\nauthor: \n  - Gema Fernández-Avilés \n  - Isidro Higalgo\nformat: html\ntheme: cerulean\nhighlight-style: ayu-mirage\nself-contained: true\ndate: \"2024-12-17\"\ncode-link: true\nnumber-sections: true\nexecute:\n  code-overflow: scroll\n  echo: true\n  eval: true\n  output: true\n  include: true\n  freeze: auto\n  fig-height: 5\n  warning: false\n  code-fold: true\n  comment: \"#>\"\n  code-line-numbers: true\n  code-copy: true\n---\n\n\n\n# Contexto\n\nMi jefa me ha dado un conjunto de datos en Excel porque quiere saber cuáles son los mejores pisos para invertir en cada barrio de Madrid. ¡Menuda privilegiada, la jefa!¡Quién tuviera pasta para invertir en pisos madrileños!... En fin, vamos al lío, a ver qué le podemos contar a esta mujer...\n\n# Carga de bibliotecas\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse) # procesamiento de datos\nlibrary(ggplot2)    # gráficos\nlibrary(readxl)    # carga de datos en Excel\n```\n:::\n\n\n\n# Carga de datos\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndatos <- read_xlsx(\"../data/housing_price_madrid_NA_gema.xlsx\")\nstr(datos)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\ntibble [1,000 × 52] (S3: tbl_df/tbl/data.frame)\n $ Obs.                         : num [1:1000] 595 219 745 555 77 ...\n $ barrio                       : chr [1:1000] \"Imperial\" \"Imperial\" \"Imperial\" \"Imperial\" ...\n $ cod_barrio                   : num [1:1000] 21 21 21 21 21 21 21 21 22 22 ...\n $ distrito                     : chr [1:1000] \"arganzuela\" \"arganzuela\" \"arganzuela\" \"arganzuela\" ...\n $ cod_distrito                 : num [1:1000] 2 2 2 2 2 2 2 2 2 2 ...\n $ longitud                     : num [1:1000] -3.72 -3.72 -3.72 -3.72 -3.72 ...\n $ latitud                      : num [1:1000] 40.4 40.4 40.4 40.4 40.4 ...\n $ X                            : num [1:1000] 438850 438847 439054 439255 438974 ...\n $ Y                            : num [1:1000] 4473641 4473767 4473177 4473101 4473014 ...\n $ precio.house.em2             : num [1:1000] 4800 3356 4000 4592 3303 ...\n $ sup.const                    : num [1:1000] 75 73 35 65 47 75 55 78 65 60 ...\n $ sup.util                     : num [1:1000] 60 59 29 46 40 69 48 57 55 53 ...\n $ ref.hip.zona                 : num [1:1000] 3410 3524 4082 3928 3812 ...\n $ hipot.mens                   : num [1:1000] 1372 934 534 1138 592 ...\n $ dorm                         : num [1:1000] 3 2 1 1 2 2 3 3 2 1 ...\n $ banos                        : num [1:1000] 1 1 1 1 1 1 1 1 1 1 ...\n $ tipo.house.                  : chr [1:1000] \"piso\" \"piso\" \"piso\" \"piso\" ...\n $ planta.house.                : chr [1:1000] \"septima\" \"primera\" NA \"cuarta\" ...\n $ inter.exter.                 : chr [1:1000] \"exterior\" \"interior\" \"interior\" \"exterior\" ...\n $ ascensor.                    : chr [1:1000] \"si\" \"si\" \"si\" \"si\" ...\n $ aire.acond.                  : chr [1:1000] \"no\" \"si\" \"no\" \"si\" ...\n $ armar.emp.                   : chr [1:1000] \"no\" \"si\" \"no\" \"si\" ...\n $ agua.cal.                    : chr [1:1000] \"Electrica\" \"Individual\" \"Gas_Butano\" \"Gas_Natural\" ...\n $ calef.                       : chr [1:1000] \"Centr_Com.\" \"Individual\" \"Electrica\" \"Gas_Natural\" ...\n $ cocina.                      : chr [1:1000] \"si\" \"si\" \"si\" \"si\" ...\n $ tendedero.                   : chr [1:1000] \"no\" \"si\" \"no\" \"si\" ...\n $ orientac.                    : chr [1:1000] \"norte\" NA \"este\" \"2_o_mas\" ...\n $ estado.                      : chr [1:1000] \"buen_estado\" \"reformado\" \"buen_estado\" \"buen_estado\" ...\n $ trastero.                    : chr [1:1000] \"no\" \"no\" \"no\" \"no\" ...\n $ piscina.                     : chr [1:1000] \"no\" \"no\" \"no\" \"si\" ...\n $ garaje.                      : chr [1:1000] \"no\" \"no\" \"no\" \"no\" ...\n $ antig                        : num [1:1000] 25 30 22.3 2.5 40 ...\n $ antig.interv                 : chr [1:1000] \"(18.9,27]\" \"(27,34.8]\" \"(18.9,27]\" \"[0,9.08]\" ...\n $ comercial                    : num [1:1000] 1 1 1 1 1 1 1 0 1 1 ...\n $ casco.historico              : num [1:1000] 1 1 1 1 1 1 1 0 1 1 ...\n $ transp.publ.                 : chr [1:1000] \"bueno\" \"bueno\" \"malo\" \"bueno\" ...\n $ Ruidos_ext                   : num [1:1000] 0.39 0.39 0.39 0.39 0.39 0.39 0.39 0.39 0.42 0.42 ...\n $ Mal_olor                     : num [1:1000] 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.31 0.35 0.35 ...\n $ Poca_limp                    : num [1:1000] 0.49 0.49 0.49 0.49 0.49 0.49 0.49 0.49 0.48 0.48 ...\n $ Malas_comunic                : num [1:1000] 0.22 0.22 0.22 0.22 0.22 0.22 0.22 0.22 0.14 0.14 ...\n $ Pocas_zonas                  : num [1:1000] 0.28 0.28 0.28 0.28 0.28 0.28 0.28 0.28 0.24 0.24 ...\n $ Delincuencia                 : num [1:1000] 0.33 0.33 0.33 0.33 0.33 0.33 0.33 0.33 0.4 0.4 ...\n $ M.30                         : num [1:1000] 0 0 0 0 0 0 0 0 0 0 ...\n $ CO                           : num [1:1000] 0.0321 0.0019 0.2068 0.267 0.2485 ...\n $ NO2                          : num [1:1000] 0.192 0.122 0.628 0.932 0.47 ...\n $ Nox                          : num [1:1000] 0.106 0.067 0.35 0.521 0.262 ...\n $ O3                           : num [1:1000] 0.787 0.724 1.126 1.328 1.015 ...\n $ SO2                          : num [1:1000] -0.373 -0.356 -0.441 -0.503 -0.413 ...\n $ PM10                         : num [1:1000] 0.0849 0.0857 0.1167 0.1574 0.0965 ...\n $ Pobl.0_14_div_Poblac.Total   : num [1:1000] 12.4 12.4 12.4 12.4 12.4 ...\n $ PoblJubilada_div_Poblac.Total: num [1:1000] 16.5 16.5 16.5 16.5 16.5 ...\n $ Inmigrantes.porc             : num [1:1000] 12.1 12.1 12.1 12.1 12.1 ...\n```\n\n\n:::\n\n```{.r .cell-code}\ndatos\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,000 × 52\n    Obs. barrio  cod_barrio distrito cod_distrito longitud latitud      X      Y\n   <dbl> <chr>        <dbl> <chr>           <dbl>    <dbl>   <dbl>  <dbl>  <dbl>\n 1   595 Imperi…         21 arganzu…            2    -3.72    40.4 4.39e5 4.47e6\n 2   219 Imperi…         21 arganzu…            2    -3.72    40.4 4.39e5 4.47e6\n 3   745 Imperi…         21 arganzu…            2    -3.72    40.4 4.39e5 4.47e6\n 4   555 Imperi…         21 arganzu…            2    -3.72    40.4 4.39e5 4.47e6\n 5    77 Imperi…         21 arganzu…            2    -3.72    40.4 4.39e5 4.47e6\n 6   712 Imperi…         21 arganzu…            2    -3.71    40.4 4.40e5 4.47e6\n 7    93 Imperi…         21 arganzu…            2    -3.72    40.4 4.39e5 4.47e6\n 8  1732 Imperi…         21 arganzu…            2    -3.72    40.4 4.39e5 4.47e6\n 9  1949 Acacias         22 arganzu…            2    -3.70    40.4 4.40e5 4.47e6\n10     6 Acacias         22 arganzu…            2    -3.71    40.4 4.40e5 4.47e6\n# ℹ 990 more rows\n# ℹ 43 more variables: precio.house.em2 <dbl>, sup.const <dbl>, sup.util <dbl>,\n#   ref.hip.zona <dbl>, hipot.mens <dbl>, dorm <dbl>, banos <dbl>,\n#   tipo.house. <chr>, planta.house. <chr>, inter.exter. <chr>,\n#   ascensor. <chr>, aire.acond. <chr>, armar.emp. <chr>, agua.cal. <chr>,\n#   calef. <chr>, cocina. <chr>, tendedero. <chr>, orientac. <chr>,\n#   estado. <chr>, trastero. <chr>, piscina. <chr>, garaje. <chr>, …\n```\n\n\n:::\n:::\n\n\nSe me ocurre que podríamos, simplificándolo mucho, hacer un modelo lineal con muy pocas variables, a ver qué sale, y ver si hay atípicos, con precios por encima del modelo. Podemos hacer esto para cada distrito, y darle los mejores pisos a la jefa. Ahora que lo pienso, si le presento una buena visualización, quizá me atreva a... ¡pedirle una comisión!\n\n# Modelo lineal sencillo\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodelo <- lm(precio.house.em2 ~ sup.util + dorm + banos + piscina., data = datos)\nsummary(modelo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = precio.house.em2 ~ sup.util + dorm + banos + piscina., \n    data = datos)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3244.1  -815.6  -156.2   642.8  5052.8 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 3864.505    107.296  36.017  < 2e-16 ***\nsup.util       1.980      1.394   1.421   0.1557    \ndorm        -408.849     49.976  -8.181 1.06e-15 ***\nbanos        442.046     93.931   4.706 2.96e-06 ***\npiscina.si   205.253    108.940   1.884   0.0599 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1176 on 824 degrees of freedom\n  (171 observations deleted due to missingness)\nMultiple R-squared:  0.1155,\tAdjusted R-squared:  0.1112 \nF-statistic: 26.91 on 4 and 824 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\nufff, vaya mierda de modelo. En fin, mañana sigo...\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}