{
  "hash": "ac8303009f0de2ced8584baeb0b5751e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Storytelling visual con R. Lab 2 con Starwars ‚öî\"\nsubtitle: \"Curso formativo para el PDI. Universidad de Castilla-La Mancha\"\nauthor:   \n  - name: Gema Fern√°ndez-Avil√©s \n    email: gema.faviles@uclm.es\n  - name: Isidro Hidalgo\n    email: isidro.hidalgo@uclm.es \ndate: \"2025-03-10\"\nformat:\n  html:\n    theme: cerulean\n    highlight-style: ayu-mirage\n    self-contained: true\n    lang: es\n    date-format: long\n    embed-resources: true\n    toc-title: Summary\n    toc: true\n    number-sections: true\n    preview-links: auto\n    code-link: true\nnumber-sections: true\nexecute:\n  echo: true\n  eval: true\n  output: true\n  include: true\n  freeze: auto\n  fig-height: 5\n  warning: false\n  comment: \"#>\"\n  code-line-numbers: true\n  code-copy: true\n  code-overflow: scroll\n---\n\n\n\n\n\n::: {.callout-warning}\n## IMPORTANTE\n\nüìï **Como buen estudiante que eres, sabr√°s lo importante que es trabajar de forma aut√≥noma y venir a clase con el material le√≠do üòä**. \n\nü¶Ñ <mark> Este icono indica **AVANZADO E IMPORTANTE**</mark>\n\n:::\n\n\n**Paso (i):** Lectura de paquetes\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)    # Visualizaci√≥n de datos\nlibrary(dplyr)      # Manipulaci√≥n de datos\nlibrary(ggpmisc)    # A√±ade la linea de regresi√≥n en el plot\n```\n:::\n\n\n\n\n**Paso (ii):** Lectura y visualizaci√≥n de los datos \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(starwars)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 √ó 14\n  name      height  mass hair_color skin_color eye_color birth_year sex   gender\n  <chr>      <int> <dbl> <chr>      <chr>      <chr>          <dbl> <chr> <chr> \n1 Luke Sky‚Ä¶    172    77 blond      fair       blue            19   male  mascu‚Ä¶\n2 C-3PO        167    75 <NA>       gold       yellow         112   none  mascu‚Ä¶\n3 R2-D2         96    32 <NA>       white, bl‚Ä¶ red             33   none  mascu‚Ä¶\n4 Darth Va‚Ä¶    202   136 none       white      yellow          41.9 male  mascu‚Ä¶\n5 Leia Org‚Ä¶    150    49 brown      light      brown           19   fema‚Ä¶ femin‚Ä¶\n6 Owen Lars    178   120 brown, gr‚Ä¶ light      blue            52   male  mascu‚Ä¶\n# ‚Ñπ 5 more variables: homeworld <chr>, species <chr>, films <list>,\n#   vehicles <list>, starships <list>\n```\n\n\n:::\n:::\n\n\n\n**Paso (iii)** Punto de partida\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = starwars,\n       mapping = aes(x = height,\n                     y = mass,\n                     colour = gender)) +\n  geom_point() +\n  labs(title = \"Mass vs. height of Starwars characters\",\n       x = \"Height (cm)\", \n       y = \"Weight (kg)\",\n       colour = \"Gender\")  \n```\n\n::: {.cell-output-display}\n![](lab_session2_files/figure-html/starwars2-10-1.png){width=672}\n:::\n:::\n\n\n\n\n::: {.callout-warning title=\"Tu turno\"}\n## Tu turno\n\nCompleta las partes del c√≥digo se√±aladas por `_____` o `xxxxx` para obtener el resultado deseado y acu√©rdate de cambiar `eval: false` por `eval: true` cuando lo hayas cumplimentado para que se ejecute correctamente la chunk.\n:::\n\n\n\n# Unidad 4. üòî El desorden es tu enemigo\n\nPara evitar el desorden, podemos simplificar la visualizaci√≥n eliminando elementos innecesarios y enfoc√°ndonos en lo esencial. ¬øSon necesarios los `NA` en este caso? ¬øEl fondo gris aporta informaci√≥n?\n\n**Paso 1** Elimino los datos faltantes, NA (Not Avaliable) con la funci√≥n `is.na()`, indicando que filtre los que son distintos a NA (con el operador `!`). Guardo el nuevo conjunot de datos en el objeto `starwars_clean`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstarwars_clean <- starwars |>\n  filter(!is.na(gender))\n```\n:::\n\n\n\n**Paso 2** Compruebo que no tengo `NAs` con la funci√≥n `is.na()`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(is.na(starwars_clean))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    name           height           mass         hair_color     \n Mode :logical   Mode :logical   Mode :logical   Mode :logical  \n FALSE:83        FALSE:77        FALSE:56        FALSE:78       \n                 TRUE :6         TRUE :27        TRUE :5        \n skin_color      eye_color       birth_year         sex         \n Mode :logical   Mode :logical   Mode :logical   Mode :logical  \n FALSE:83        FALSE:83        FALSE:43        FALSE:83       \n                                 TRUE :40                       \n   gender        homeworld        species          films        \n Mode :logical   Mode :logical   Mode :logical   Mode :logical  \n FALSE:83        FALSE:73        FALSE:83        FALSE:83       \n                 TRUE :10                                       \n  vehicles       starships      \n Mode :logical   Mode :logical  \n FALSE:83        FALSE:83       \n                                \n```\n\n\n:::\n:::\n\n\n\n**Paso 3** Cambio el tema del fondo del gr√°fico. Prueba algunos y elige el que consideres m√°s apropiado: `theme_bw()`, `theme_minimal()`, `theme_light()`, `theme_dark()`,...\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = starwars_clean,\n       mapping = aes(x = height, \n                     y = mass, \n                     colour = gender)) +\n  geom_point() +\n  labs(title = \"Mass vs. Height of Starwars Characters\",\n       x = \"Height (cm)\", y = \"Weight (kg)\",\n       colour = \"Gender\") +\n  theme_xxx()\n```\n:::\n\n\n\n\n\n\n# Unidad 5. üõë Centra la atenci√≥n de tu audiencia\n\nPara centrar la atenci√≥n, podemos analizar ciertos puntos de inter√©s, como los personajes con alturas y pesos extremos.\n\n**Paso 1** Centro la atenci√≥n en el personaje *outlier* para ver qui√©n es. Para ello filtro (`filter()`) los valores de la variable `mass > 1000` e indico que ponga una etiqueta con la variable `label = name` .\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(starwars_clean |> \n         filter(_____ > ____), \n       aes(x = ___, \n           y = ___, \n           label = ____, \n           colour = ____)) +\n  geom_point() +\n  geom_text(hjust = 1.1, vjust = 1.1, size = 3) +\n  labs(title = \"Characters with Mass Greater than 1000\",\n       x = \"Height (cm)\", \n       y = \"Weight (kg)\",\n       colour = \"Gender\") +\n  theme_bw() \n```\n:::\n\n\n\n\n**Paso 2** Determinamos el conjunto de datos objetivo. En este caso, eliminamos el personaje *outlier*, `Jabba Desilijic Tiure`, del conjunto de datos `starwars_clean` y lo guardamos en el objeto `starwars_clean_sin_outlier`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstarwars_clean_sin_outlier <- starwars_clean |>\n      filter(name != \"Jabba Desilijic Tiure\")\n```\n:::\n\n\n\n\n**Paso 3** Representamos el diagrama de dispersi√≥n del conjunto de datos `starwars_clean_sin_outlier`.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(starwars_clean_sin_outlier,\n       mapping = aes(x = height, \n                     y = mass, \n                     colour = gender)) +\n  geom_point() +\n  labs(title = \"Mass vs. Height of Starwars Characters (Excluding Jabba)\",\n       x = \"Height (cm)\", y = \"Weight (kg)\",\n       colour = \"Gender\") +\n    theme_bw()\n```\n:::\n\n\n\n\n# Unidad 6. üé® Piensa como un dise√±ador\n\nPara pensar como un dise√±ador, podemos usar colores y formas que hagan la visualizaci√≥n m√°s atractiva y f√°cil de entender.\n\n**Paso 1** A√±ade colores y formas al gr√°fico, adem√°s de la fuente de los datos.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(starwars_clean_sin_outlier, \n       mapping = aes(x = height, \n                     y = mass, \n                     colour = gender, \n                     ______ = gender)) +\n  geom_point(size = 3) +\n  labs(title = \"Mass vs. Height of Starwars Characters\",\n       x = \"Height (cm)\", \n       y = \"Weight (kg)\",\n       colour = \"Gender\", \n       ______ = \"Gender\",\n       caption = \"Source: dplyr package\") +\n  theme_minimal() +\n  scale_colour_viridis_d() +\n  theme(legend.position = \"bottom\")\n```\n:::\n\n\n\n\n\n\n# Unidad 7. üìñ Cuenta una historia\n\nPara contar una historia, podemos agregar anotaciones que expliquen los datos y gu√≠en al espectador a trav√©s de la visualizaci√≥n.\n\n\n**Paso 1** Destaca los personajes m√°s importantes y cambia la escala de color.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(starwars_clean_sin_outlier, \n       mapping = aes(x = height, \n                     y = mass, \n                     colour = gender)) +\n  geom_point(size = 3) +\n  geom_text(aes(label = ifelse(name %in% c(\"Darth Vader\", \"Luke Skywalker\", \"Leia Organa\", \"Yoda\"), \n                               name, \" \")),  \n            size = 5) +\n  labs(title = \"Mass vs. Height of Starwars Characters\",\n       subtitle = \"Highlighting Key Characters\",\n       x = \"Height (cm)\", y = \"Weight (kg)\",\n       colour = \"Gender\",\n       caption = \"Source: dplyr package\") +\n  theme_minimal() +\nscale_colour_brewer(palette = \"Set2\")\n```\n\n::: {.cell-output-display}\n![](lab_session2_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n\n\n**Paso 2** A√±ade una linea de regresi√≥n con sus coeficientes y el R2.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(starwars_clean_sin_outlier, \n       mapping = aes(x = height, \n                     y = mass, \n                     colour = gender)) +\n  geom_point(size = 3) +\n  geom_smooth(method = \"lm\", se = FALSE, aes(colour = gender)) +  # L√≠nea de regresi√≥n por g√©nero\n  stat_poly_eq(aes(label = paste(..eq.label.., ..rr.label.., sep = \"~~~\"), \n                   colour = gender), \n               formula = y ~ x, \n               parse = TRUE, label.x.npc = \"right\", label.y.npc = \"top\") +\n  labs(title = \"Mass vs. Height of Starwars Characters\",\n       x = \"Height (cm)\", y = \"Weight (kg)\",\n       colour = \"Gender\",\n       caption = \"Source: dplyr package\") +\n  theme_minimal() +\n  scale_colour_brewer(palette = \"Set2\") +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](lab_session2_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n![](img/logos_finan.png){align=\"right\"}\n",
    "supporting": [
      "lab_session2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}