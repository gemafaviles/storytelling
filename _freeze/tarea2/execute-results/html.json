{
  "hash": "9ef18427d9d4b26bc1aa1e8d365afd54",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"¬øQu√© pasa con la renta municipal en Espa√±a?\"\nauthor:\n  - name: Nombre y apellidos\n    email: mail\n  - name: Nombre y apellidos\n    email: mail\n  - si hay m√°s autores...\nformat:\n  html:\n    theme: superhero  ## cambia el tema a tu gusto  \n    highlight-style: ayu-mirage\n    self-contained: true\n    lang: es\n    logo: img/logos_finan.png\n    date: 04/25/2025\n    date-format: long\n    embed-resources: true\n    toc-title: Summary\n    toc: true\n    number-sections: true\n    preview-links: auto\n    code-link: true\n    code-fold: false\nnumber-sections: true\nexecute:\n  echo: false\n  eval: true\n  output: true\n  include: true\n  freeze: auto\n  fig-height: 5\n  warning: false\n  comment: \"#>\"\n  code-line-numbers: true\n  code-copy: true\n  code-overflow: scroll\n  code-fold: true\n---\n\n\n\n\n\n# Planteamiento\n\nTrabajas en una compa√±√≠a privada que planea lanzar un producto de alta gama. Tu jefe te ha solicitado un informe sobre la renta municipal en Espa√±a de los √∫ltimos a√±os, ya que el CEO quiere expandir el mercado a ciertos segmentos de renta alta y necesita identificar √°reas con potencial de negocio.\n\nTu objetivo es encontrar segmentos de mercado con capacidad adquisitiva para un producto de alta gama, por lo que es crucial analizar la variable renta e identificar d√≥nde reside la poblaci√≥n con mayores ingresos.\n\n## Los datos\n\nTrabajaremos con la **renta neta per c√°pita (en euros) por municipios**. Esta informaci√≥n proviene del *Atlas de distribuci√≥n de renta de los hogares* del Instituto Nacional de Estad√≠stica y ha sido procesada para facilitar su an√°lisis. Los datos se cargar√°n desde el archivo Excel `tarea2_renta.xlsx`.\n\nSe ha realizado un an√°lisis exploratorio inicial para limpiar los datos y analizar las variables de inter√©s. \n\nLa descripci√≥n de las variables de renta es la siguiente: contamos con 6.424 registros de renta municipal de toda Espa√±a, abarcando un per√≠odo de 5 a√±os, desde 2015 hasta 2019, con cada a√±o representado en una columna. Al analizar la media y las cinco medidas de posici√≥n de las variables cuantitativas, detectamos una asimetr√≠a positiva, lo cual es com√∫n en distribuciones de rentas o salariales.\n\nAdem√°s, se trabajar√° con un **objeto espacial**, `municipios`, que contiene la geometr√≠a de los municipios espa√±oles. Este objeto est√° disponible en la librer√≠a `CDR`.\n\n## Objetivo\n\nTu tarea consiste en **contar una historia** con la informaci√≥n que obtengas de estos datos, mejorar los gr√°ficos incluidos en este archivo de Quarto y crear otros nuevos para presentar la informaci√≥n al jefe **de la manera m√°s visual posible**. El resultado final debe ser claro y conciso. Elimina todo aquello que no sea necesario para el informe final (enunciados de ejercicios, comentarios, etc).\n\n\n\n\n\n# üÜò ¬°No te preocupes! Te iremos guiando a lo largo del proceso üÜò\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n\n::: {#exr-1}\n## üë®‚Äçüíª ¬øPuedes mejorar este histograma?\n\nModifica el siguiente chunk de c√≥digo, reemplazando las partes se√±aladas por `_____` o `xxxxx` para obtener el resultado propuesto.\n:::\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](tarea2_files/figure-html/histograma-2019-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\n\n::: {#exr-2}\n## üë®‚Äçüíª Funci√≥n de densidad de la renta del a√±o 2019\n\nComo visualizaci√≥n alternativa se presenta igualmente la funci√≥n de densidad de la renta. Tendr√°s que usar la funci√≥n `geom_density()` dentro de un gr√°fico de ggplot, habiendo elegido previamente las variables adecuadas en el argumento `mapping = aes()` de la funci√≥n `ggplot()`.\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n::: {#exr-3}\n## üë®‚Äçüíª Diagrama de cajas y de viol√≠n de la renta del a√±o 2019\n\nDeber√°s utilizar las funciones `geom_boxplot()` y `geom_violin()` dentro de un gr√°fico de `ggplot()`, eligiendo previamente las variables adecuadas en el argumento `mapping = aes()`. \n\nAsigna el gr√°fico a un objeto (por ejemplo, ll√°malo `graf`). Luego, crea dos objetos usando un c√≥digo similar a este: `caja <- graf + geom_boxplot()` y `violin <- graf + geom_violin()`. \nFinalmente, presenta ambos gr√°ficos juntos usando `caja + violin` en una sola l√≠nea, para que el paquete `patchwork` haga su magia. \n\nLa estructura del c√≥digo ser√≠a la siguiente:\n\n+ `graf <- ggplot()`\n+ `caja <- graf + ggplot()`\n+ `violin <-  graf + ggplot()`\n+ `caja + violin`\n:::\n \n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n::: {#exr-4}\n## üë®‚Äçüíª Evoluci√≥n temporal de la renta neta municipal\n\nDeber√°s utilizar la funci√≥n `geom_line()` dentro de un gr√°fico de ggplot, eligiendo previamente las variables adecuadas en el argumento `mapping = aes()` de la funci√≥n `ggplot()`. Para facilitarte las cosas, ya hemos calculado la mediana de cada a√±o y hemos creado un `data frame` llamado `medianas`, con el cual podr√°s construir f√°cilmente el gr√°fico requerido. Aunque este gr√°fico es sencillo, no te conformes con un gr√°fico sin sustancia. Usa el color con elegancia, a√±ade etiquetas en los ejes, un t√≠tulo impactante... todo lo que ya sabes hacer para mejorar la presentaci√≥n.\n\n:::\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n::: {.callout-note}\n## IMPORTANTE\n\nEs evidente que existe una fuerte relaci√≥n entre la renta de todos los a√±os. Sin embargo, quer√≠amos incluir este tipo de gr√°fico y la matriz de correlaci√≥n en el ejercicio, ya que son muy comunes en nuestro √°mbito de trabajo (docente, cient√≠fico y divulgativo).\n:::\n\n\n::: {#exr-5}\n## üë®‚Äçüíª Gr√°ficos de correlaci√≥n\n\nDeber√°s utilizar la funci√≥n `geom_point()` y, si lo consideras interesante, puedes completar el gr√°fico con `geom_smooth()`, que a√±adir√° una l√≠nea de tendencia con el intervalo de confianza integrado en la curva.\n:::\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n::: {#exr-6}\n## üë®‚Äçüíª Matriz de correlaci√≥n\n\nUna matriz de correlaci√≥n es extremadamente √∫til, especialmente cuando se trabaja con muchas variables, ya que permite identificar relaciones entre las variables explicativas. Esto puede ayudar a descartar algunas variables, reducir la dimensionalidad del problema y mejorar el rendimiento del modelo.\n\nTe recomendamos utilizar la funci√≥n `corrplot()` del paquete del mismo nombre, `corrplot`. Selecciona una configuraci√≥n que se ajuste a tu estilo, ya que el paquete ofrece una amplia variedad de visualizaciones. Para obtener m√°s informaci√≥n sobre las opciones disponibles, consulta la ayuda de la funci√≥n ejecutando: `?corrplot`.\n:::\n\n::: {.callout-note}\n## CUIDADO\nAunque es evidente, recuerda utilizar solo variables cuantitativas\n:::\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n::: {#exr-7}\n## üë®‚Äçüíª ¬øC√≥mo modificar√≠as este c√≥digo para mejorar la visualizaci√≥n del mapa b√°sico que hemos incluido?\n\nEl gr√°fico incluido tiende a uniformizar los municipios debido a la escala de colores utilizada.\n\nAlgunas ideas para mejorar la visualizaci√≥n:\n\n+ Elige una escala adecuada: Considera usar escalas como `viridis` o `inferno`, e investiga si la direcci√≥n de la escala es adecuada. Prueba los tonos en orden inverso para ver cu√°l funciona mejor.\n+ A√±ade un t√≠tulo adecuado: Incluye un t√≠tulo descriptivo y, si lo consideras √∫til, un subt√≠tulo que aporte contexto adicional.\n+ Estratifica la graduaci√≥n de renta: Esta es una tarea m√°s compleja. Dise√±a una escala discreta para la graduaci√≥n de renta utilizando la funci√≥n `classIntervals()` del paquete `classInt`, aplicando el m√©todo `Fisher-Jenks`.\n:::\n\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](tarea2_files/figure-html/ejercicio7-tu-turno-1.png){width=672}\n:::\n:::\n\n\n\n\n\n::: {#exr-8}\n## üë®‚Äçüíª ¬øQuienes son los 20 municipios con mayor renta neta en Espa√±a en 2019? Graficos de tipo `lollipop`\n\nConstruye un gr√°fico lollipop con la renta por municipios, usando todo lo aprendido en el curso (t√≠tulo, subt√≠tulo, aspectos est√©ticos, simplicidad, elegancia, baja carga cognitiva, eficiencia, etc.)\n\nLos gr√°ficos de tipo `lollipop` pueden ser complejos, pero en ocasiones son muy efectivos, especialmente cuando se integran con otras representaciones.\n\nPara hacerlo correctamente, ten en cuenta lo siguiente:\n\n+ Orden descendente: El municipio con mayor renta debe aparecer en la parte superior, y el resto en orden descendente.\n+ Dibujar l√≠neas: Utiliza `geom_segment()`, especificando los valores inicial y final de cada segmento, tanto en `x` como en `y`, para dibujar las l√≠neas.\n+ Puntos finales: Usa `geom_point()` para los puntos finales.\n+ Ordenar municipios: Para ordenar los municipios por la variable `anyo2019`, utiliza `reorder()` en el mapeo. Esta funci√≥n requiere dos argumentos: el primero es la variable a ordenar (el nombre del municipio) y el segundo es la variable que ordena (la renta de 2019).\n\n:::\n\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n",
    "supporting": [
      "tarea2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}